define(["jquery","common/views/BaseView","common/util/eventify"],function(e,s,t){var i={collapsedClass:"collapsed",openClass:"open",popoutClass:"popout"};return s.extend({el:"#wrapper > aside > .main-nav",events:function(){var s={"click > li:has(ul) > a":"onMainItemClick"};return this.isCollapsed&&(s=e.extend(s,{"mouseenter > li":"onMainItemMouseenter","mouseleave > li":"onMainItemMouseleave"})),s},isCollapsed:!1,options:{},resizeTimeout:null,initialize:function(s){this.options=e.extend({},i,s),this.$("> li").filter(".active").prev().addClass("prev-active"),this.collapseMenu(),this.listenTo(t(window),"resize",_.bind(this.onResize,this))},collapseMenu:function(){var e=this.isCollapsed;this.isCollapsed="none"===this.$("> li > a > .item-name").first().css("display"),this.isCollapsed?(this.$el.addClass(this.options.collapsedClass),this.isCollapsed!==e&&this.delegateEvents(this.events())):(this.$el.removeClass(this.options.collapsedClass),this.delegateEvents(this.events()))},getEventTarget:function(s,t){var i=e(s.target);return i.is("li")?i:(t=t||"",i.closest("li"+t))},onMainItemClick:function(e){this.getEventTarget(e).toggleClass(this.options.openClass)},onMainItemMouseenter:function(e){this.isCollapsed&&this.getEventTarget(e).addClass(this.options.popoutClass)},onMainItemMouseleave:function(e){this.isCollapsed&&this.getEventTarget(e,"."+this.options.popoutClass).removeClass(this.options.popoutClass)},onResize:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(_.bind(this.collapseMenu,this),100)}})});