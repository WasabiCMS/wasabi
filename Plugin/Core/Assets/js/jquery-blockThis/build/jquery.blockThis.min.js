/*!
 * jQuery blockThis v0.0.1
 */
!function(a){"use strict";var b=function(b,c){this.$el=a(b),this.settings=a.extend({},a.fn.block.defaults,c),this.$blockBackdrop=a('<div class="block-backdrop"></div>'),this.numberOfBlocks=0,this._primaryEvents=[],this._buildEvents()};b.prototype={_buildEvents:function(){this._primaryEvents=[[a(document),"",[["mousedown mouseup keydown keypress keyup touchstart touchend touchmove",a.proxy(this._handler,this)]]]]},_handler:function(b){var c=this.$el;(b.target===this.$blockBackdrop[0]||a(b.target).parents().filter(function(){return a(this)[0]===c[0]}).length>0)&&(b.preventDefault(),b.stopPropagation())},_block:function(){if(this.numberOfBlocks++,this.numberOfBlocks>1&&"function"==typeof this.settings.onBlock)return this.settings.onBlock.call(this),void 0;var b=this.$el.offset();this.$blockBackdrop.css({position:"absolute",top:b.top,left:b.left,width:this.$el.innerWidth(),height:this.$el.innerHeight(),backgroundColor:this.settings.backgroundColor,opacity:this.settings.opacity,cursor:this.settings.cursor,zIndex:9997}).hide(),a("body").append(this.$blockBackdrop),this.$blockBackdrop.fadeIn(100,a.proxy(function(){this.$blockBackdrop.spin("large"),a.attachEvents(this._primaryEvents),this.settings.onBlock.call(this)},this))},_unblock:function(b){this.numberOfBlocks>=1&&this.numberOfBlocks--,0===this.numberOfBlocks&&(b=b||function(){},this.$blockBackdrop.spin(!1),this.$blockBackdrop.remove(),a.detachEvents(this._primaryEvents),"function"==typeof b&&b.call(this))}},a.fn.block=function(c){return this.each(function(){return a(this).data("blockThis")||a(this).data("blockThis",new b(this,c)),a(this).data("blockThis")._block(),a(this)})},a.fn.block.defaults={backgroundColor:"#000",opacity:.6,cursor:"wait",onBlock:function(){}},a.fn.unblock=function(b){return this.each(function(){return a(this).data("blockThis")?(a(this).data("blockThis")._unblock(b),a(this)):a(this)})}}(jQuery);