/*!
 * jQuery Modal v0.0.1
 *
 * Copyright (c) 2013 Frank FÃ¶rster (http://frankfoerster.com)
 * Licensed under the MIT License
 */
!function(a,b){"use strict";var c=function(b,c){this.o=a.extend({},a.fn.modal.defaults,c),this.$el=a(b),this.isConfirm="confirm"===this.$el.attr("data-toggle"),this.$target=a(this.$el.attr("data-target")),this.$targetContents=null,this.$backdrop=null,this.$scrollable=null,this.$container=null,this.isOpen=!1,this.header=!1,this.body=!1,this.footer=!1,this.isAjax=!1,this.$notify=!1,this.event=!1,this.method=!1,this.action=!1,this._primaryEvents=[],this._secondaryEvents=[],this.useTarget=this.$target.length>0,this.init()};c.prototype=function(){function c(b){this._primaryEvents=[[this.$el,{click:a.proxy(h,this)}]],b===!0&&(this._secondaryEvents=[[this.$scrollable,{click:a.proxy(function(a){a.target===this.$scrollable[0]&&i.call(this,a)},this)}],[this.$container,'[data-dismiss="modal"]',[["click",a.proxy(i,this)]]],[this.$container,'[type="submit"]',[["click",a.proxy(l,this)]]],[a(window),{resize:a.proxy(k,this)}]])}function d(){this.$backdrop=a("<div/>").addClass(this.o.backdrop).css({opacity:this.o.opacity,zIndex:1e4}),this.$scrollable=a("<div/>").addClass(this.o.scrollable).css({zIndex:this.$backdrop.css("zIndex")+1}),this.$container=a("<div/>").addClass(this.o.container)}function e(){this.useTarget&&(this.$target.append(this.$targetContents),this.$targetContents=null),this.$container.remove(),this.$container=null,m.removeClass("modal-open").removeClass("page-overflow"),this.$scrollable.remove(),this.$scrollable=null,this.$backdrop.remove(),this.$backdrop=null}function f(){var c=this.$el.attr("data-modal-title");void 0!==c&&(this.header=c);var d=this.$el.attr("data-modal-body");if(void 0!==d&&(this.body=d),this.method=this.$el.attr("data-method")||"post",this.isAjax="1"===this.$el.attr("data-ajax")||"true"===this.$el.attr("data-ajax"),this.isAjax){var e=this.$el.attr("data-notify");this.$notify=e?a(e):a(b),this.event=this.$el.attr("data-event")||"succes.modal"}this.action=this.$el.attr("data-action")||this.$el.attr("href")||!1}function g(){if(this.useTarget)this.$targetContents=this.$target.children(),this.$container.append(this.$targetContents);else{var b=this.$el.attr("data-modal-title"),c=this.$el.attr("data-modal-body"),d=!1,e=a("<div/>",{"class":this.o.body}),f=!1;if(void 0!==b&&"0"!==b&&(d=a("<div/>",{"class":this.o.header}).append(a("<span/>").text(b))),void 0!==c&&e.append(c),this.isConfirm){f=a("<div/>",{"class":this.o.footer+" "+this.o.confirmFooter});var g=a("<button/>",{"class":"button",type:"submit"});g.append(a("<span/>").text(this.o.confirmYes));var h=a('<a href="javascript:void(0)" data-dismiss="modal"/>');h.text(this.o.confirmNo),f.append(g).append(h)}d&&this.$container.append(d),e&&this.$container.append(e),f&&this.$container.append(f)}}function h(b){b.preventDefault(),a.detachEvents(this._primaryEvents),d.call(this),c.call(this,!0),a.attachEvents(this._secondaryEvents),m.toggleClass("page-overflow",a(window).height()<a(document).height()).addClass("modal-open"),f.call(this),g.call(this),this.$container.css({width:this.o.width,position:"fixed",left:-99999,top:this.o.offsetTop}),this.$scrollable.append(this.$container),m.append(this.$backdrop).append(this.$scrollable),j.call(this),this.$container.hide(),this.$container.fadeIn(),this.isOpen=!0}function i(b){b&&b.preventDefault(),a.detachEvents(this._secondaryEvents),a.when.apply(null,[this.$container.fadeOut(200),this.$backdrop.fadeOut(200)]).then(a.proxy(function(){e.call(this),this.isOpen=!1,a.attachEvents(this._primaryEvents)},this))}function j(){var a=this.$container.outerHeight(),b=this.$container.offset().top-this.$scrollable.offset().top,c=this.$scrollable.height(),d=c-a-b<this.o.offsetTop;d?a+2*this.o.padding<=c?this.$container.css({top:"50%",marginTop:-a/2}):this.$container.css({top:this.o.padding,marginTop:0}):this.$container.css({top:this.o.offsetTop,marginTop:0}),this.$container.css({position:"absolute",marginLeft:-this.o.width/2,left:"50%"})}function k(){this.isOpen&&j.call(this)}function l(b){b.preventDefault();var c=a(b.target);if(void 0===c.attr("disabled")){if(this.isAjax){var d=this;c.attr("disabled",!0),this.$notify.trigger("beforeAjax.modal"),a.ajax({type:this.method,url:this.action,cache:!1,success:function(a){d.$notify.trigger(d.event,a)}})}else a("<form></form>").attr("action",this.action).attr("method",this.method).appendTo("body").submit();i.call(this)}}var m=a("body");return{init:function(){c.call(this),a.attachEvents(this._primaryEvents)}}}(),a.fn.modal=function(b){return this.each(function(){return a(this).data("Modal")||a(this).data("Modal",new c(this,b)),a(this).data("Modal")})},a.fn.modal.defaults={width:400,offsetTop:200,opacity:.6,padding:20,backdrop:"modal-backdrop",scrollable:"modal-scrollable",container:"modal-container",header:"modal-header",body:"modal-body",footer:"modal-footer",confirmFooter:"modal-confirm",confirmYes:"Yes",confirmNo:"No"}}(jQuery,document);