/*!
 * jQuery MultiSelect v0.9.8
 *
 * Copyright (c) 2012 Louis Cuny
 * Licensed under the Do What The Fuck You Want * To Public License
 */
!function(a){"use strict";var b=function(b,c){this.settings=a.extend({},a.fn.multiSelect.defaults,c),this.$el=a(b),this.$container=a("<div/>",{"class":"ms-container row"}),this.$available=a("<ul/>",{"class":"ms-list",tabindex:"-1"}),this.$selection=null,this.init()};b.prototype=function(){function c(){var b=this;this.$el.css({position:"absolute",left:"-9999px"}),this.$el.find("option").each(function(c,e){d.call(b,a(e))}),this.$selection=this.$available.clone(),this.$selection.addClass("ms-selection").attr("unselectable","on").css("user-select","none").on("selectstart",!1),this.$available.addClass("ms-available").attr("unselectable","on").css("user-select","none").on("selectstart",!1),this.$el.find("option[selected]").each(function(c,d){var f=b.$available.find('.ms-item[data-value="'+a(d).attr("value")+'"]');e.call(b,f,!0)}),i.call(this),this.$el.attr("disabled")?this.$container.addClass("disabled"):a.attachEvents(this._primaryEvents),this.$container.append(this.$available).append(this.$selection),this.$el.after(this.$container)}function d(b){var c=a("<li/>",{"class":"ms-item"}).attr("data-value",b.attr("value")).text(b.attr("value")),d=b.parent("optgroup");if(b.attr("disabled")&&c.addClass(this.settings.disabledClass),0!==d.length){var e=d.attr("label"),f=this.$available.find('li[data-optgrp="'+e+'"]');if(0===f.length){var g=a("<li/>",{"class":"ms-optgrp"}).attr("data-optgrp",e).append(a("<span/>").text(e)).append(a("<ul/>"));this.$available.append(g),f=this.$available.find('li[data-optgrp="'+e+'"]')}f.find("> ul").append(c)}else this.$available.append(c)}function e(a,b){var c=a.attr("data-value"),d=this.$available.find('li[data-value="'+c+'"]').addClass("active");g.call(this,d);var e=this.$selection.find('li[data-value="'+c+'"]').addClass("active");h.call(this,e),b||this.$el.find('option[value="'+c+'"]').prop("selected",!0)}function f(a){var b=a.attr("data-value"),c=this.$available.find('li[data-value="'+b+'"]').removeClass("active");g.call(this,c);var d=this.$selection.find('li[data-value="'+b+'"]').removeClass("active");h.call(this,d),this.$el.find('option[value="'+b+'"]').prop("selected",!1)}function g(a){var b=a.parent().parent(".ms-optgrp");1===b.length&&(0===b.find("> ul li:not(.active)").length?b.addClass("all-active"):b.removeClass("all-active"))}function h(a){var b=a.parent().parent(".ms-optgrp");1===b.length&&(b.find("> ul li.active").length>0?b.addClass("active"):b.removeClass("active"))}function i(){this._primaryEvents=[[this.$el,{focus:a.proxy(j,this),blur:a.proxy(k,this),keydown:a.proxy(o,this)}],[this.$container,".ms-item:not(."+this.settings.disabledClass+")",[["mouseenter",a.proxy(l,this)],["mouseleave",a.proxy(m,this)],["click",a.proxy(n,this)]]]]}function j(){this.$available.hasClass("ms-focus")||this.$selection.hasClass("ms-focus")||this.$available.addClass("ms-focus"),this.disableTimeout=!1}function k(){if(this.disableTimeout)this.$available.removeClass("ms-focus"),this.$selection.removeClass("ms-focus");else{var a=this;setTimeout(function(){a.$el.is(":focus")||(a.$available.removeClass("ms-focus"),a.$selection.removeClass("ms-focus"))},100)}}function l(b){var c=a(b.target);c.parents().is(this.$available)?this.$available.find(".ms-item").removeClass("hover"):this.$selection.find(".ms-item").removeClass("hover"),c.addClass("hover")}function m(b){var c=a(b.target);c.removeClass("hover")}function n(b){var c=a(b.target);c.parents().is(this.$selection)?(this.$selection.addClass("ms-focus"),this.$available.removeClass("ms-focus")):(this.$available.addClass("ms-focus"),this.$selection.removeClass("ms-focus")),this.$el.focus(),c.hasClass("active")?f.call(this,c):e.call(this,c)}function o(a){switch(a.which){case 40:case 38:a.preventDefault(),a.stopPropagation(),p.call(this,38===a.which?1:-1);break;case 32:a.preventDefault(),a.stopPropagation();var b;b=this.$available.hasClass("ms-focus")?this.$available.find(".ms-item.hover").first():this.$selection.find(".ms-item.hover").first(),b.removeClass("hover"),b.hasClass("active")?f.call(this,b):e.call(this,b);break;case 37:case 39:a.preventDefault(),a.stopPropagation(),this.$available.hasClass("ms-focus")&&39===a.which?(this.$available.removeClass("ms-focus"),this.$selection.addClass("ms-focus")):this.$selection.hasClass("ms-focus")&&37===a.which&&(this.$selection.removeClass("ms-focus"),this.$available.addClass("ms-focus"));break;case 9:this.disableTimeout=!0}}function p(b){var c,d,e,f,g;if(this.$available.hasClass("ms-focus")?(g=this.$available,c=g.find(".ms-item.hover"),d=g.find(".ms-item:not(.active):not(."+this.settings.disabledClass+")")):(g=this.$selection,c=g.find(".ms-item.hover"),d=g.find(".ms-item.active:not(."+this.settings.disabledClass+")")),d.removeClass("hover"),-1===b?c.length>0?(f=d.index(c)+1,f>d.length-1&&(f=0)):f=0:c.length>0?(f=d.index(c)-1,0>f&&(f=d.length-1)):f=d.length-1,e=a(d.get(f)),e.length>0){e.addClass("hover");var h=g.scrollTop()+e.position().top-(g.height()+e.outerHeight())/2;g.scrollTop(h)}}return{constructor:b,init:function(){c.call(this)},selectAll:function(){var b=this;this.$available.find(".ms-item:not(.active):not(."+this.settings.disabledClass+")").each(function(c,d){e.call(b,a(d))})},deselectAll:function(){var b=this;this.$available.find(".ms-item.active:not(."+this.settings.disabledClass+")").each(function(c,d){f.call(b,a(d))})},enable:function(){return this.$el.attr("disabled")&&(this.$el.prop("disabled",!1),a.attachEvents(this._primaryEvents),this.$container.removeClass("disabled")),this.$el},disable:function(){return this.$el.attr("disabled")||(a.detachEvents(this._primaryEvents),this.$el.attr("disabled","disabled"),this.$container.addClass("disabled")),this.$el}}}(),a.fn.multiSelect=function(c){if(!c||"object"==typeof c)return this.each(function(){a(this).data("multiSelect")||a(this).data("multiSelect",new b(this,c))});if("string"==typeof c&&"_"!==c.charAt(0)){var d=this.data("multiSelect");if(!d)throw new Error("multiSelect is not initialized on this DOM element.");if(d&&d[c])return d[c].apply(d,Array.prototype.slice.apply(arguments,[1]))}throw new Error('"'+c+'" is no valid api method.')},a.fn.multiSelect.defaults={disabledClass:"disabled"}}(window.jQuery);